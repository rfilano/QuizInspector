<html>
  <head>
    <title>Quiz Inspector</title>
    <script
      src="https://code.jquery.com/jquery-3.5.1.min.js"
      integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/jquery.form/4.3.0/jquery.form.min.js"
      integrity="sha384-qlmct0AOBiA2VPZkMY3+2WqkHtIQ9lSdAsAn5RUJD/3vA5MKDgSGcdmIv4ycVxyn"
      crossorigin="anonymous"
    ></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.2.1/dist/css/bootstrap.min.css"
      integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.14.6/dist/umd/popper.min.js"
      integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.2.1/dist/js/bootstrap.min.js"
      integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k"
      crossorigin="anonymous"
    ></script>
  </head>
  <h1>Quiz Inspector</h1>
  <body>
    <h2>Upload a file</h2>
    <form
      method="POST"
      enctype="multipart/form-data"
      action="/response"
      id="upload_form"
    >
      <label>Audience:</label>
      <input type="text" name="audience" value="" /><br /><br />
      <label>API Key:</label>
      <input type="text" name="api_key" value="" /><br /><br />
      <label> Test PDF: </label><input type="file" name="upload" /><br /><br />
      <p>
        The default prompt analyzes the difficulty of each problem for the
        audience.
      </p>
      <br />
      <label>Prompt Customization - Select your options below:</label><br />
      <input type="checkbox" name="checkbox1" value="g" />
      <label for="checkbox1">Sample Answers: Good Student</label><br />
      <input type="checkbox" name="checkbox2" value="a" />
      <label for="checkbox2">Sample Answers: Average Student</label><br />
      <input type="checkbox" name="checkbox3" value="p" />
      <label for="checkbox3">Sample Answers: Poor Student</label><br />
      <input type="checkbox" name="checkbox4" value="d" />
      <label for="checkbox4">Divergence of Each Question</label><br />
      <input type="checkbox" name="checkbox5" value="r" />
      <label for="checkbox5">Relevence to Audience</label><br />
      <input type="submit" id="submit" value="Submit" />
      <div class="spinner-border text-dark" role="status" id="spinner">
        <span class="sr-only">Loading...</span>
      </div>
    </form>
    <p id="form_output">This was here originally</p>

    <script>
      document.getElementsByName("audience")[0].onchange = (evt) => {
        localStorage.setItem("audience", evt.target.value);
      };
      const audience = localStorage.getItem("audience");
      if (audience != null) {
        document.getElementsByName("audience")[0].value = audience;
      }
      document.getElementsByName("api_key")[0].onchange = (evt) => {
        localStorage.setItem("api_key", evt.target.value);
      };
      const api_key = localStorage.getItem("api_key");
      if (api_key != null) {
        document.getElementsByName("api_key")[0].value = api_key;
      }
      $(function () {
        $("#spinner").hide();
        $("#upload_form").ajaxForm({
          beforeSubmit: () => {
            $("#submit").prop("disabled", true);
            $("#spinner").show();
          },
          error: function (error) {
            console.error(error);
            document.getElementById("form_output").innerHTML =
              error.responseText;
            $("#submit").prop("disabled", false);
            $("#spinner").hide();
          },
          success: function (submit_response) {
            console.log(submit_response);
            document.getElementById("form_output").innerText = submit_response;
            $("#submit").prop("disabled", false);
            $("#spinner").hide();
          },
        });
      });
    </script>
  </body>
</html>
